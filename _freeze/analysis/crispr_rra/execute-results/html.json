{
  "hash": "1f81a151e7309967d29354542b33360f",
  "result": {
    "markdown": "---\ntitle: \"CRISPR Screen RRA Analysis\"\nauthor: \"daiuc\"\ndate: \"2023-01-03\"\nformat: \n  html:\n    code-fold: true\noutput: \n    workflowr::wflow_html:\n      code_folding: hide\n---\n\n\n## Introduction\n\n**Td- vs. iN at Day14 (S8/S6):**\n\n-   These cells became non-neurons, the **enrichment** of guides found from S8 / S6 means that these guides discrupt TFs that may be crucial to neuron development. Because these cells failed to become neurons, **enrichment** of these guides mean TFs responsible for neuron development are disrupted.\n\n\n**Td- vs. Td+ at Day14 (S8/S7)**\n\n-   S8 are non-neurons and S7 are neurons. The **enrichment** of guides found in neurons, while depleted in non-neurons, mean that these guides disrupte the function of TFs that are responsible for neuron development.\n\n\n**Td+ vs. iN at Day14 (S7/S6)**\n\n-   These cells became neurons. The **enrichment** of guides found from S7 - S6 means that these guides disrupt TFs that may be repressors of neuron development, or that these targetted TFs are reponsible for maintaining stem cell status.\n\n-   The **depletion** of these guides means that the targeted TFs may be crucial to neuron development (since these cells have become neurons, you wouldn't find many cells with neuron related TFs being disrupted, thus you observe depletion of gRNAs).\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#cnts.file = \"../../resources/crispr/counts/RC.csv\"\ncnts.file = \"../code/resources/crispr/counts/wrangled_raw_counts.tsv\" # raw file\n#cnts.rn.file = \"../../resources/crispr/counts/wrangled_ranknorm_counts.tsv\" # rank normalized\n#cnts.l2.file = \"/gpfs/commons/groups/sanjana_lab/cdai/TFscreen/RCmNorRatioLog2.lu.csv\"\n\ncnts = fread(cnts.file) %>% .[, .(ID=sgRNA, Gene, S6 = Day14_iN, S7=Day14_Tdpos, S8=Day14_Tdneg)]\n#cnts.l2 = fread(cnts.l2.file) %>% .[, .(ID, Gene, S6, S7, S8)]\n\n\n# group 10 NTC guides into 1 NTC group\nNTC = paste(\"NonTargeting_Human_\", sort(rep(1:100, 10)), sep=\"\")\ncnts[str_detect(toupper(Gene), \"NONTARGET\"), Gene := NTC]\n\n# remove any guides where S6 or iN is 1 or less\n# remove genes that have less than 5 guides left at iN or S6\ncnts = cnts[S6 > 1]\ncnts = cnts[, .(ID, S6, S7, S8, .N), by = Gene][N>4, -c(\"N\")]\n\nselcols = c(\"S6\", \"S7\", \"S8\")\n# log2 RPM normalize counts\ncnts.norm = cnts[, c(\n    list(ID = ID, Gene = Gene),\n    lapply(.SD, function(x) log2(if_else(x==0, .1, .1*x)*1e6/sum(x)) )\n), .SDcols = selcols]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmakeDT = function(dt, dt.norm) {\n    # dt: is raw counts,\n    # dt.norm: is the same, but normalized\n    # columns: ID, Gene, denom, num\n    \n    # both denom and num conditions must have at least 2 guides with reads > 0\n    genes1 = dt[denom > 0, .N, by = Gene][N>1, Gene] %>% unique\n    genes2 = dt[num > 0, .N, by = Gene][N>1, Gene] %>% unique\n    genes = intersect(genes1, genes2)\n    \n    dt = dt[Gene %in% genes & denom > 0 & num > 0]\n    dt.norm = dt.norm[Gene %in% genes]\n    \n    dt.out = dt.norm[dt[, .(ID, Gene)], on = c(\"Gene\", \"ID\"), nomatch=NULL]\n    \n    return(dt.out)\n}\n\nweightedSum = function(x) {\n    # x must be a numerical vector of exactly 2 elements\n    # x must be sorted, x[1] <= x[2]\n    return(0.25*x[1] + 0.75*x[2]) # more weights no the second rank\n}\n\nRRA = function(dt, enrichment) {\n    # dt is a dataframe with column ID, Gene, denom, num (which are Log2 RPM normalized reads)\n    dt = dt[, .(ID, Gene, denom, num, l2fc = num - denom)] # compute l2fc\n    if (enrichment) {\n        dt = dt[, .(ID, Gene,l2fc, rk=rank(-l2fc, ties.method = \"max\"))] # look for enriched guides\n    } else {\n        dt = dt[, .(ID, Gene,l2fc, rk=rank(l2fc, ties.method = \"max\"))] # look for depleted guides\n    }\n    dt = dt[order(Gene, rk), .SD[1:2], by = Gene # select top 2 guides for each gene\n            ][, .(rankscore = weightedSum(rk)), by = Gene\n             ][order(rankscore)]\n    return(dt)\n}\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## Compute enrichment or depletion\n\nResult shown in the next section.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# enrichment of guides in td- vs. iN (S8 VS. S6)\ndtS86 = makeDT(dt = cnts[, .(ID, Gene, denom = S6, num = S8)],\n               dt.norm = cnts.norm[, .(ID, Gene, denom = S6, num = S8)])\nrraS86 = RRA(dtS86, enrichment = T)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# enrichment of guides in td- vs. td+ (S8 VS. S7)\ndtS87 = makeDT(dt = cnts[, .(ID, Gene, denom = S7, num = S8)],\n               dt.norm = cnts.norm[, .(ID, Gene, denom = S7, num = S8)])\nrraS87 = RRA(dtS87, enrichment = T)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# depletion of guides in td+ vs. iN (S7 VS. S6)\ndtS76 = makeDT(dt = cnts[, .(ID, Gene, denom = S6, num = S7)],\n               dt.norm = cnts.norm[, .(ID, Gene, denom = S6, num = S7)])\nrraS76 = RRA(dtS76, enrichment = F)\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## Monte Carlo simulation\n\nSimulations are set to run 20 iterations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nN_sim = 20 # number of simulations\n\nsim.rraS86.l = list()\nfor (i in 1:N_sim) {\n    sim.cnts = cnts[\n        , .(Gene, ID,\n           S6 = S6[sample(length(S6))],\n           S7 = S7[sample(length(S7))],\n           S8 = S8[sample(length(S8))])]\n    \n    selcols = c(\"S6\", \"S7\", \"S8\")\n    # log2 RPM normalize counts\n    sim.cnts.norm = sim.cnts[, c(list(ID = ID, Gene = Gene),\n        lapply(.SD, function(x) log2(if_else(x==0, .1, .1*x)*1e6/sum(x)) )), \n        .SDcols = selcols]\n               \n    sim.dtS86 = makeDT(dt = sim.cnts[, .(ID, Gene, denom = S6, num = S8)],\n               dt.norm = sim.cnts.norm[, .(ID, Gene, denom = S6, num = S8)])\n    sim.rraS86 = list(RRA(sim.dtS86, enrichment = T))\n    sim.rraS86.l = c(sim.rraS86.l, sim.rraS86)\n}\n\n# get ecdf\necdf.S86 = ecdf(map(sim.rraS86.l, ~.x$rankscore) %>% flatten %>% unlist)\n\n# use ecdf to compute FDR value\nrraS86[, FDR := ecdf.S86(rankscore)]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nN_sim = 20 # number of simulations\n\nsim.rraS87.l = list()\nfor (i in 1:N_sim) {\n    sim.cnts = cnts[\n        , .(Gene, ID,\n           S6 = S6[sample(length(S6))],\n           S7 = S7[sample(length(S7))],\n           S8 = S8[sample(length(S8))])]\n    \n    selcols = c(\"S6\", \"S7\", \"S8\")\n    # log2 RPM normalize counts\n    sim.cnts.norm = sim.cnts[, c(list(ID = ID, Gene = Gene),\n        lapply(.SD, function(x) log2(if_else(x==0, .1, .1*x)*1e6/sum(x)) )), \n        .SDcols = selcols]\n               \n    sim.dtS87 = makeDT(dt = sim.cnts[, .(ID, Gene, denom = S7, num = S8)],\n               dt.norm = sim.cnts.norm[, .(ID, Gene, denom = S7, num = S8)])\n    sim.rraS87 = list(RRA(sim.dtS87, enrichment = T))\n    sim.rraS87.l = c(sim.rraS87.l, sim.rraS87)\n}\n\n# get ecdf\necdf.S87 = ecdf(map(sim.rraS87.l, ~.x$rankscore) %>% flatten %>% unlist)\n\n# use ecdf to compute FDR value\nrraS87[, FDR := ecdf.S87(rankscore)]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nN_sim = 20 # number of simulations\n\nsim.rraS76.l = list()\nfor (i in 1:N_sim) {\n    sim.cnts = cnts[\n        , .(Gene, ID,\n           S6 = S6[sample(length(S6))],\n           S7 = S7[sample(length(S7))],\n           S8 = S8[sample(length(S8))])]\n    \n    selcols = c(\"S6\", \"S7\", \"S8\")\n    # log2 RPM normalize counts\n    sim.cnts.norm = sim.cnts[, c(list(ID = ID, Gene = Gene),\n        lapply(.SD, function(x) log2(if_else(x==0, .1, .1*x)*1e6/sum(x)) )), \n        .SDcols = selcols]\n               \n    sim.dtS76 = makeDT(dt = sim.cnts[, .(ID, Gene, denom = S6, num = S7)],\n               dt.norm = sim.cnts.norm[, .(ID, Gene, denom = S6, num = S7)])\n    sim.rraS76 = list(RRA(sim.dtS76, enrichment = F))\n    sim.rraS76.l = c(sim.rraS76.l, sim.rraS76)\n}\n\n# get ecdf\necdf.S76 = ecdf(map(sim.rraS76.l, ~.x$rankscore) %>% flatten %>% unlist)\n\n# use ecdf to compute FDR value\nrraS76[, FDR := ecdf.S76(rankscore)]\n```\n:::\n\n\n### Enrichment of Td- vs. iN at Day14, with MC computed FDR, genes with FDR \\< 0.15 are shown\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrraS86[!is.na(rankscore) & FDR < .15]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      Gene rankscore          FDR\n  1:                ZNF441     28.75 0.0004593126\n  2:                ZNF440     49.25 0.0021434586\n  3:                ZBTB18     83.75 0.0067365842\n  4:                  CRY1     88.00 0.0074255531\n  5:                 BRWD1     88.25 0.0074255531\n ---                                             \n100:                 RCOR2    411.25 0.1387889459\n101: NonTargeting_Human_57    412.50 0.1399372273\n102: NonTargeting_Human_73    417.25 0.1428462068\n103:              MPHOSPH8    423.75 0.1472096762\n104:                NBPF24    424.75 0.1479751971\n```\n:::\n:::\n\n\n### Enrichment of Td- vs. Td+ at Day14, with MC computed FDR\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrraS87[!is.na(rankscore) & FDR < .15]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                     Gene rankscore          FDR\n 1:                ZNF441     10.75 0.0002468526\n 2:                ZNF440     53.25 0.0032090842\n 3:                  CRY1     54.25 0.0033736526\n 4:                  E2F1     77.75 0.0072410105\n 5:                  CDX4     81.25 0.0075701473\n 6:               BHLHA15     84.50 0.0080638525\n 7:                ZNF311     95.50 0.0099563894\n 8:                  EGR3    105.50 0.0124249157\n 9:                  ZIC1    107.75 0.0128363367\n10:                 NR1I2    112.75 0.0143174525\n11:                ZNF250    133.25 0.0189253682\n12:                ZNF639    133.25 0.0189253682\n13:                 PRDM6    135.00 0.0190899366\n14:                  DLX5    136.75 0.0195836419\n15:                  TOX4    139.75 0.0203241998\n16:                  THRA    140.00 0.0203241998\n17:                 BRWD1    143.50 0.0212293261\n18:                  CHD5    145.00 0.0214761787\n19:                  CBX4    162.50 0.0272360734\n20:                  VAX2    162.50 0.0272360734\n21:                ZBTB18    164.75 0.0277297787\n22:                 RAI14    165.00 0.0278120629\n23:                  RBPJ    166.25 0.0279766313\n24:                 TSHZ3    171.00 0.0293754628\n25:                NKX3-2    173.75 0.0301160207\n26:                 TAF1L    176.75 0.0311857155\n27:                 APBB2    178.50 0.0320908418\n28:                 SCRT2    180.00 0.0327491154\n29:                 HSFY1    183.25 0.0336542418\n30:                ZNF136    190.00 0.0365341891\n31:                  EMX1    197.75 0.0395787048\n32:                 UBE2K    197.75 0.0395787048\n33:                 CTDP1    204.25 0.0426232206\n34:                  JUNB    206.25 0.0436106311\n35:                 MECP2    209.25 0.0445980416\n36:                POLR2B    210.00 0.0450917469\n37:                  ZZZ3    210.00 0.0450917469\n38: NonTargeting_Human_22    212.50 0.0459968732\n39:                ZNF554    214.00 0.0469842837\n40:                 KLF10    220.50 0.0498642311\n41:                 INSM1    229.50 0.0541430100\n42:                 MEOX2    232.00 0.0552127047\n43:                ZNF671    232.00 0.0552127047\n44: NonTargeting_Human_90    236.50 0.0571875257\n45:                 SMAD3    239.00 0.0586686415\n46:                  EBF1    240.00 0.0594091994\n47:                ZNF563    250.25 0.0644285362\n48:                  PAX7    252.00 0.0654159467\n49:                ZNF141    253.00 0.0656627993\n50:                 ZFPM1    258.75 0.0677199046\n51:             HIST1H2BC    264.00 0.0701061466\n52:                  JUND    267.75 0.0717518308\n53:               HTATIP2    268.75 0.0719986835\n54:                 PRDM5    280.25 0.0781699992\n55:                 GATA1    295.00 0.0852464412\n56:                  TFEB    296.50 0.0863161359\n57:                CREBZF    297.50 0.0871389780\n58:                 VGLL2    297.75 0.0871389780\n59:                   SKI    298.00 0.0873858307\n60:                   ZFY    298.00 0.0873858307\n61:                 HIF3A    301.75 0.0893606517\n62: NonTargeting_Human_13    306.00 0.0919937464\n63:                  ELK3    318.00 0.0982473463\n64: NonTargeting_Human_31    319.00 0.0990701884\n65: NonTargeting_Human_57    319.25 0.0991524726\n66:                  ZIM3    320.25 0.0995638937\n67:                ARID1B    323.50 0.1013741463\n68:                   AHR    324.75 0.1017032831\n69: NonTargeting_Human_88    325.25 0.1019501358\n70:                 NFAT5    328.50 0.1042540936\n71:               NEUROG3    333.25 0.1077923147\n72:               TSC22D3    335.50 0.1085328725\n73:                  LHX4    341.00 0.1114951041\n74: NonTargeting_Human_69    341.75 0.1119888093\n75:                ZNF239    343.25 0.1130585041\n76: NonTargeting_Human_39    346.75 0.1145396198\n77:                  SIX5    347.25 0.1147041883\n78:                ZNF510    355.25 0.1193943882\n79:                  PAX2    357.00 0.1199703777\n80:                 ZNF92    362.50 0.1232617461\n81:                CTNNB1    363.75 0.1239200197\n82:                  TAF5    365.25 0.1247428618\n83:                NFKBIB    368.00 0.1267999671\n84: NonTargeting_Human_99    369.75 0.1271291039\n85:               ZKSCAN3    380.00 0.1333827039\n86:                  AFF4    380.75 0.1345346828\n87:                 ATF6B    381.00 0.1345346828\n88:                 ARNTL    381.25 0.1346992512\n89:                 TCEA2    382.25 0.1354398091\n90:                 PHF12    384.50 0.1370854933\n91:              MPHOSPH8    385.25 0.1374969143\n92:                 ZNF34    390.75 0.1407882827\n93:                  RORB    397.25 0.1446556406\n94:                 HOXB3    399.25 0.1468773142\n                     Gene rankscore          FDR\n```\n:::\n:::\n\n\n### Depletion of Td+ vs. iN at Day14, with MC computed FDR\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrraS76[FDR < .15]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Gene rankscore          FDR\n  1:   MXI1     62.50 0.0005569620\n  2:  NCOA3     65.00 0.0006329114\n  3:  NR5A2     70.25 0.0008101266\n  4:   TFEC     84.00 0.0011392405\n  5: HIF1AN     87.50 0.0011645570\n ---                              \n306:  NFKB1   1176.50 0.1460253165\n307:   TBX5   1176.50 0.1460253165\n308: ANKRD1   1177.75 0.1462278481\n309: ZNF229   1178.25 0.1463291139\n310:    SP4   1193.25 0.1493417722\n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Compare with hits found from existing method, using FDR\\< .15\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhitlist = fread(\"../code/resources/crispr/Hitlist_20191230.csv\")\n```\n:::\n\n\nPrevious method found 122 genes, shown below:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"PHOX2A\"    \"TAF1L\"     \"TFEB\"      \"VAX2\"      \"SNAI2\"     \"ELK3\"     \n  [7] \"ISL2\"      \"ZBTB43\"    \"ZNF200\"    \"MLLT6\"     \"NFAT5\"     \"ZNF563\"   \n [13] \"ZNF3\"      \"ZFY\"       \"ZNF502\"    \"RCOR2\"     \"TSC22D3\"   \"NR1I2\"    \n [19] \"RBPJ\"      \"HSFY1\"     \"TAF5\"      \"RAI14\"     \"PHF12\"     \"BRWD1\"    \n [25] \"FOXQ1\"     \"CREBZF\"    \"EMX1\"      \"ZNF324\"    \"ZIM3\"      \"ZNF311\"   \n [31] \"ZNF136\"    \"EGR3\"      \"ASB1\"      \"CBX4\"      \"GTF2A2\"    \"ZKSCAN3\"  \n [37] \"HOXC13\"    \"ZNF671\"    \"ZNF639\"    \"KLF10\"     \"JADE3\"     \"ARID1B\"   \n [43] \"ZNF547\"    \"CNOT6\"     \"EBF1\"      \"AHR\"       \"PAX7\"      \"POLR2B\"   \n [49] \"SIX5\"      \"CDX4\"      \"GATA1\"     \"ZNF573\"    \"NKX3-2\"    \"ZNF250\"   \n [55] \"POU2F3\"    \"PRDM5\"     \"NBPF24\"    \"ZNF34\"     \"SKI\"       \"E2F1\"     \n [61] \"ARNTL\"     \"MEOX2\"     \"AIP\"       \"ZNF510\"    \"ZNF440\"    \"DLX5\"     \n [67] \"HIF3A\"     \"SOX15\"     \"APBB2\"     \"TOX4\"      \"ZNF239\"    \"FOXN2\"    \n [73] \"SCRT2\"     \"RORB\"      \"CRY1\"      \"ZNF92\"     \"JUND\"      \"CEBPA\"    \n [79] \"INSM1\"     \"ZNF441\"    \"THRA\"      \"NKRF\"      \"MPHOSPH8\"  \"NR1D2\"    \n [85] \"ZFPM1\"     \"JUNB\"      \"TBPL1\"     \"ZNF141\"    \"BHLHA15\"   \"EHF\"      \n [91] \"ZZZ3\"      \"ZIC1\"      \"POU3F2\"    \"HOXB3\"     \"KLF14\"     \"CTDP1\"    \n [97] \"VGLL2\"     \"AFF4\"      \"ZNF282\"    \"MECP2\"     \"TCEA2\"     \"SLA2\"     \n[103] \"TSHZ3\"     \"NFKBIB\"    \"PAX2\"      \"POLR2J\"    \"ZFP2\"      \"ZNF107\"   \n[109] \"ZBTB18\"    \"CHD5\"      \"CTNNB1\"    \"ZNF554\"    \"UBE2K\"     \"HTATIP2\"  \n[115] \"NEUROG3\"   \"SMAD3\"     \"LHX4\"      \"PRDM6\"     \"NEUROG1\"   \"NEUROG2\"  \n[121] \"HIST1H2BC\" \"HIST1H1E\" \n```\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics(\"venn.svg\")\n```\n\n::: {.cell-output-display}\n![](venn.svg)\n:::\n:::\n\n\n\n\n\n\nNotice a large number of overlaps. When we combine hits found from Td- vs. iN and Td- vs. Td+ with FDR \\< 0.15 (which is the same way we selected our 120 hits. There are 23 (NEUROG1 and NEUROG2 are not considered) hits found in existing method, but not found in the RRA method. Nearly all the hits that we initially removed in our existing method, which are labeled as hit with the RRA method are non-targeting controls. This highlights the advantage of our existing manual method of more precise control of false positives and potential false negatives. Of course, the disadvantage is that the existing manual method does not produce a p-value thus is less informative in statistical confidence.\n\nBelow shows hits that are found in both this method and our existing method. Notice many of these TFs are repeatedly identified as differentially expressed as well as later identified as nodes in the putative neuronal development gene regulatory network.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nintersect(union(set87, set86), hitlist$gene_name) %>% length\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 97\n```\n:::\n\n```{.r .cell-code}\nintersect(union(set87, set86), hitlist$gene_name)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"ZNF441\"    \"ZNF440\"    \"CRY1\"      \"E2F1\"      \"CDX4\"      \"BHLHA15\"  \n [7] \"ZNF311\"    \"EGR3\"      \"ZIC1\"      \"NR1I2\"     \"ZNF250\"    \"ZNF639\"   \n[13] \"PRDM6\"     \"DLX5\"      \"TOX4\"      \"THRA\"      \"BRWD1\"     \"CHD5\"     \n[19] \"CBX4\"      \"VAX2\"      \"ZBTB18\"    \"RAI14\"     \"RBPJ\"      \"TSHZ3\"    \n[25] \"NKX3-2\"    \"TAF1L\"     \"APBB2\"     \"SCRT2\"     \"HSFY1\"     \"ZNF136\"   \n[31] \"EMX1\"      \"UBE2K\"     \"CTDP1\"     \"JUNB\"      \"MECP2\"     \"POLR2B\"   \n[37] \"ZZZ3\"      \"ZNF554\"    \"KLF10\"     \"INSM1\"     \"MEOX2\"     \"ZNF671\"   \n[43] \"SMAD3\"     \"EBF1\"      \"ZNF563\"    \"PAX7\"      \"ZNF141\"    \"ZFPM1\"    \n[49] \"HIST1H2BC\" \"JUND\"      \"HTATIP2\"   \"PRDM5\"     \"GATA1\"     \"TFEB\"     \n[55] \"CREBZF\"    \"VGLL2\"     \"SKI\"       \"ZFY\"       \"HIF3A\"     \"ELK3\"     \n[61] \"ZIM3\"      \"ARID1B\"    \"AHR\"       \"NFAT5\"     \"NEUROG3\"   \"TSC22D3\"  \n[67] \"LHX4\"      \"ZNF239\"    \"SIX5\"      \"ZNF510\"    \"PAX2\"      \"ZNF92\"    \n[73] \"CTNNB1\"    \"TAF5\"      \"NFKBIB\"    \"ZKSCAN3\"   \"AFF4\"      \"ARNTL\"    \n[79] \"TCEA2\"     \"PHF12\"     \"MPHOSPH8\"  \"ZNF34\"     \"RORB\"      \"HOXB3\"    \n[85] \"ISL2\"      \"ZNF502\"    \"FOXQ1\"     \"HOXC13\"    \"POU2F3\"    \"POLR2J\"   \n[91] \"TBPL1\"     \"AIP\"       \"ZNF282\"    \"CNOT6\"     \"ZNF547\"    \"RCOR2\"    \n[97] \"NBPF24\"   \n```\n:::\n:::\n\n\nBelow are hits that are found in our existing method but missed in this method.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetdiff(hitlist$gene_name, union(set87, set86))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"PHOX2A\"   \"SNAI2\"    \"ZBTB43\"   \"ZNF200\"   \"MLLT6\"    \"ZNF3\"    \n [7] \"ZNF324\"   \"ASB1\"     \"GTF2A2\"   \"JADE3\"    \"ZNF573\"   \"SOX15\"   \n[13] \"FOXN2\"    \"CEBPA\"    \"NKRF\"     \"NR1D2\"    \"EHF\"      \"POU3F2\"  \n[19] \"KLF14\"    \"SLA2\"     \"ZFP2\"     \"ZNF107\"   \"NEUROG1\"  \"NEUROG2\" \n[25] \"HIST1H1E\"\n```\n:::\n:::\n\n\nBelow are labeled hits in this method but rejected in our existing method. Notice many are in fact non-targeting controls, suggesting our existing method may be better suited in removing false positives.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetdiff(union(set87, set86), hitlist$gene_name)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"NonTargeting_Human_22\" \"NonTargeting_Human_90\" \"NonTargeting_Human_13\"\n [4] \"NonTargeting_Human_31\" \"NonTargeting_Human_57\" \"NonTargeting_Human_88\"\n [7] \"NonTargeting_Human_69\" \"NonTargeting_Human_39\" \"NonTargeting_Human_99\"\n[10] \"ATF6B\"                 \"NonTargeting_Human_67\" \"ZNF766\"               \n[13] \"NonTargeting_Human_64\" \"NonTargeting_Human_73\"\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
{
  "hash": "dabff925c1cfb58aa3fcbc7a8e4f79a2",
  "result": {
    "markdown": "---\ntitle: \"CRISPR Screen RRA Analysis\"\nauthor: \"daiuc\"\ndate: \"2023-01-03\"\nformat: \n  html:\n    code-fold: true\noutput: \n    workflowr::wflow_html:\n      code_folding: hide\n---\n\n\n## Introduction\n\n**Td- vs. iN at Day14 (S8/S6):**\n\n-   These cells became non-neurons, the **enrichment** of guides found from S8 / S6 means that these guides discrupt TFs that may be crucial to neuron development. Because these cells failed to become neurons, **enrichment** of these guides mean TFs responsible for neuron development are disrupted.\n\n\n**Td- vs. Td+ at Day14 (S8/S7)**\n\n-   S8 are non-neurons and S7 are neurons. The **enrichment** of guides found in neurons, while depleted in non-neurons, mean that these guides disrupte the function of TFs that are responsible for neuron development.\n\n\n**Td+ vs. iN at Day14 (S7/S6)**\n\n-   These cells became neurons. The **enrichment** of guides found from S7 - S6 means that these guides disrupt TFs that may be repressors of neuron development, or that these targetted TFs are reponsible for maintaining stem cell status.\n\n-   The **depletion** of these guides means that the targeted TFs may be crucial to neuron development (since these cells have become neurons, you wouldn't find many cells with neuron related TFs being disrupted, thus you observe depletion of gRNAs).\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#cnts.file = \"../../resources/crispr/counts/RC.csv\"\ncnts.file = \"../code/resources/crispr/counts/wrangled_raw_counts.tsv\" # raw file\n#cnts.rn.file = \"../../resources/crispr/counts/wrangled_ranknorm_counts.tsv\" # rank normalized\n#cnts.l2.file = \"/gpfs/commons/groups/sanjana_lab/cdai/TFscreen/RCmNorRatioLog2.lu.csv\"\n\ncnts = fread(cnts.file) %>% .[, .(ID=sgRNA, Gene, S6 = Day14_iN, S7=Day14_Tdpos, S8=Day14_Tdneg)]\n#cnts.l2 = fread(cnts.l2.file) %>% .[, .(ID, Gene, S6, S7, S8)]\n\n\n# group 10 NTC guides into 1 NTC group\nNTC = paste(\"NonTargeting_Human_\", sort(rep(1:100, 10)), sep=\"\")\ncnts[str_detect(toupper(Gene), \"NONTARGET\"), Gene := NTC]\n\n# remove any guides where S6 or iN is 1 or less\n# remove genes that have less than 5 guides left at iN or S6\ncnts = cnts[S6 > 1]\ncnts = cnts[, .(ID, S6, S7, S8, .N), by = Gene][N>4, -c(\"N\")]\n\nselcols = c(\"S6\", \"S7\", \"S8\")\n# log2 RPM normalize counts\ncnts.norm = cnts[, c(\n    list(ID = ID, Gene = Gene),\n    lapply(.SD, function(x) log2(if_else(x==0, .1, .1*x)*1e6/sum(x)) )\n), .SDcols = selcols]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmakeDT = function(dt, dt.norm) {\n    # dt: is raw counts,\n    # dt.norm: is the same, but normalized\n    # columns: ID, Gene, denom, num\n    \n    # both denom and num conditions must have at least 2 guides with reads > 0\n    genes1 = dt[denom > 0, .N, by = Gene][N>1, Gene] %>% unique\n    genes2 = dt[num > 0, .N, by = Gene][N>1, Gene] %>% unique\n    genes = intersect(genes1, genes2)\n    \n    dt = dt[Gene %in% genes & denom > 0 & num > 0]\n    dt.norm = dt.norm[Gene %in% genes]\n    \n    dt.out = dt.norm[dt[, .(ID, Gene)], on = c(\"Gene\", \"ID\"), nomatch=NULL]\n    \n    return(dt.out)\n}\n\nweightedSum = function(x) {\n    # x must be a numerical vector of exactly 2 elements\n    # x must be sorted, x[1] <= x[2]\n    return(0.25*x[1] + 0.75*x[2]) # more weights no the second rank\n}\n\nRRA = function(dt, enrichment) {\n    # dt is a dataframe with column ID, Gene, denom, num (which are Log2 RPM normalized reads)\n    dt = dt[, .(ID, Gene, denom, num, l2fc = num - denom)] # compute l2fc\n    if (enrichment) {\n        dt = dt[, .(ID, Gene,l2fc, rk=rank(-l2fc, ties.method = \"max\"))] # look for enriched guides\n    } else {\n        dt = dt[, .(ID, Gene,l2fc, rk=rank(l2fc, ties.method = \"max\"))] # look for depleted guides\n    }\n    dt = dt[order(Gene, rk), .SD[1:2], by = Gene # select top 2 guides for each gene\n            ][, .(rankscore = weightedSum(rk)), by = Gene\n             ][order(rankscore)]\n    return(dt)\n}\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## Compute enrichment or depletion\n\nResult shown in the next section.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# enrichment of guides in td- vs. iN (S8 VS. S6)\ndtS86 = makeDT(dt = cnts[, .(ID, Gene, denom = S6, num = S8)],\n               dt.norm = cnts.norm[, .(ID, Gene, denom = S6, num = S8)])\nrraS86 = RRA(dtS86, enrichment = T)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# enrichment of guides in td- vs. td+ (S8 VS. S7)\ndtS87 = makeDT(dt = cnts[, .(ID, Gene, denom = S7, num = S8)],\n               dt.norm = cnts.norm[, .(ID, Gene, denom = S7, num = S8)])\nrraS87 = RRA(dtS87, enrichment = T)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# depletion of guides in td+ vs. iN (S7 VS. S6)\ndtS76 = makeDT(dt = cnts[, .(ID, Gene, denom = S6, num = S7)],\n               dt.norm = cnts.norm[, .(ID, Gene, denom = S6, num = S7)])\nrraS76 = RRA(dtS76, enrichment = F)\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## Monte Carlo simulation\n\nSimulations are set to run 20 iterations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nN_sim = 20 # number of simulations\n\nsim.rraS86.l = list()\nfor (i in 1:N_sim) {\n    sim.cnts = cnts[\n        , .(Gene, ID,\n           S6 = S6[sample(length(S6))],\n           S7 = S7[sample(length(S7))],\n           S8 = S8[sample(length(S8))])]\n    \n    selcols = c(\"S6\", \"S7\", \"S8\")\n    # log2 RPM normalize counts\n    sim.cnts.norm = sim.cnts[, c(list(ID = ID, Gene = Gene),\n        lapply(.SD, function(x) log2(if_else(x==0, .1, .1*x)*1e6/sum(x)) )), \n        .SDcols = selcols]\n               \n    sim.dtS86 = makeDT(dt = sim.cnts[, .(ID, Gene, denom = S6, num = S8)],\n               dt.norm = sim.cnts.norm[, .(ID, Gene, denom = S6, num = S8)])\n    sim.rraS86 = list(RRA(sim.dtS86, enrichment = T))\n    sim.rraS86.l = c(sim.rraS86.l, sim.rraS86)\n}\n\n# get ecdf\necdf.S86 = ecdf(map(sim.rraS86.l, ~.x$rankscore) %>% flatten %>% unlist)\n\n# use ecdf to compute FDR value\nrraS86[, FDR := ecdf.S86(rankscore)]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nN_sim = 20 # number of simulations\n\nsim.rraS87.l = list()\nfor (i in 1:N_sim) {\n    sim.cnts = cnts[\n        , .(Gene, ID,\n           S6 = S6[sample(length(S6))],\n           S7 = S7[sample(length(S7))],\n           S8 = S8[sample(length(S8))])]\n    \n    selcols = c(\"S6\", \"S7\", \"S8\")\n    # log2 RPM normalize counts\n    sim.cnts.norm = sim.cnts[, c(list(ID = ID, Gene = Gene),\n        lapply(.SD, function(x) log2(if_else(x==0, .1, .1*x)*1e6/sum(x)) )), \n        .SDcols = selcols]\n               \n    sim.dtS87 = makeDT(dt = sim.cnts[, .(ID, Gene, denom = S7, num = S8)],\n               dt.norm = sim.cnts.norm[, .(ID, Gene, denom = S7, num = S8)])\n    sim.rraS87 = list(RRA(sim.dtS87, enrichment = T))\n    sim.rraS87.l = c(sim.rraS87.l, sim.rraS87)\n}\n\n# get ecdf\necdf.S87 = ecdf(map(sim.rraS87.l, ~.x$rankscore) %>% flatten %>% unlist)\n\n# use ecdf to compute FDR value\nrraS87[, FDR := ecdf.S87(rankscore)]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nN_sim = 20 # number of simulations\n\nsim.rraS76.l = list()\nfor (i in 1:N_sim) {\n    sim.cnts = cnts[\n        , .(Gene, ID,\n           S6 = S6[sample(length(S6))],\n           S7 = S7[sample(length(S7))],\n           S8 = S8[sample(length(S8))])]\n    \n    selcols = c(\"S6\", \"S7\", \"S8\")\n    # log2 RPM normalize counts\n    sim.cnts.norm = sim.cnts[, c(list(ID = ID, Gene = Gene),\n        lapply(.SD, function(x) log2(if_else(x==0, .1, .1*x)*1e6/sum(x)) )), \n        .SDcols = selcols]\n               \n    sim.dtS76 = makeDT(dt = sim.cnts[, .(ID, Gene, denom = S6, num = S7)],\n               dt.norm = sim.cnts.norm[, .(ID, Gene, denom = S6, num = S7)])\n    sim.rraS76 = list(RRA(sim.dtS76, enrichment = F))\n    sim.rraS76.l = c(sim.rraS76.l, sim.rraS76)\n}\n\n# get ecdf\necdf.S76 = ecdf(map(sim.rraS76.l, ~.x$rankscore) %>% flatten %>% unlist)\n\n# use ecdf to compute FDR value\nrraS76[, FDR := ecdf.S76(rankscore)]\n```\n:::\n\n\n### Enrichment of Td- vs. iN at Day14, with MC computed FDR, genes with FDR \\< 0.15 are shown\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrraS86[!is.na(rankscore) & FDR < .15] %>% DT::datatable() %>% DT::formatRound(\"FDR\", digits = 5)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-516a8e89cc489f2f4e46\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-516a8e89cc489f2f4e46\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\"],[\"ZNF441\",\"ZNF440\",\"ZBTB18\",\"CRY1\",\"BRWD1\",\"CDX4\",\"ZZZ3\",\"E2F1\",\"RAI14\",\"EGR3\",\"CHD5\",\"ZNF250\",\"PRDM6\",\"SCRT2\",\"TOX4\",\"ZNF639\",\"TAF1L\",\"ZNF311\",\"DLX5\",\"ZIC1\",\"BHLHA15\",\"ZNF671\",\"HSFY1\",\"CBX4\",\"THRA\",\"VAX2\",\"UBE2K\",\"KLF10\",\"EMX1\",\"EBF1\",\"JUNB\",\"NR1I2\",\"POLR2B\",\"CREBZF\",\"ZNF141\",\"ARID1B\",\"NonTargeting_Human_67\",\"NKX3-2\",\"RBPJ\",\"ZNF510\",\"NonTargeting_Human_31\",\"CTDP1\",\"ZNF554\",\"INSM1\",\"VGLL2\",\"GATA1\",\"HTATIP2\",\"ISL2\",\"TFEB\",\"TSHZ3\",\"JUND\",\"MEOX2\",\"ZNF136\",\"TSC22D3\",\"NonTargeting_Human_99\",\"PRDM5\",\"ZFPM1\",\"ZNF239\",\"NonTargeting_Human_22\",\"PHF12\",\"NFKBIB\",\"MECP2\",\"APBB2\",\"SIX5\",\"HIST1H2BC\",\"ZNF766\",\"HIF3A\",\"PAX7\",\"NEUROG3\",\"ELK3\",\"PAX2\",\"LHX4\",\"NonTargeting_Human_90\",\"CTNNB1\",\"NonTargeting_Human_13\",\"SMAD3\",\"ZKSCAN3\",\"TAF5\",\"RORB\",\"ZNF502\",\"SKI\",\"FOXQ1\",\"HOXC13\",\"ZIM3\",\"HOXB3\",\"NonTargeting_Human_64\",\"POU2F3\",\"POLR2J\",\"NFAT5\",\"TBPL1\",\"AIP\",\"NonTargeting_Human_88\",\"ZNF282\",\"ZNF92\",\"AHR\",\"CNOT6\",\"ZFY\",\"ZNF34\",\"ZNF547\",\"RCOR2\",\"NonTargeting_Human_57\"],[28.75,49.25,83.75,88,88.25,89.75,98.5,102.75,115.5,123.25,123.75,127.75,132.75,142,142,144,149.5,149.75,154.25,155.25,163.75,165.75,167.25,170.5,171.5,174,175,179.5,180,182.5,186.25,198.75,209.25,212.25,213.75,215.25,219,219.75,219.75,233,233.25,237,239.75,247.25,247.25,251.25,254,254.5,257,259,271,271,273,274.25,274.75,284.5,284.5,285,285.5,288.25,294.25,298,298.5,302.5,303.25,308.5,309,310.5,315,317,326.5,327.5,330.25,334.75,335,337.75,338.75,339.5,343.25,348,349.25,357.75,361,362.25,363.5,368.75,370.5,377.25,378.5,379.5,389.75,393.75,395.75,396.25,405.5,408,409,409,410,411.25,412.5],[0.000842524509803922,0.00283394607843137,0.00727634803921569,0.00804227941176471,0.00811887254901961,0.00827205882352941,0.00972732843137255,0.0104166666666667,0.0133272058823529,0.0153186274509804,0.0153186274509804,0.0166207107843137,0.0180759803921569,0.0199142156862745,0.0199142156862745,0.0212928921568627,0.0229013480392157,0.0229013480392157,0.0241268382352941,0.0243566176470588,0.0271139705882353,0.0278033088235294,0.028109681372549,0.0291053921568627,0.0294117647058824,0.0304074754901961,0.0305606617647059,0.0322457107843137,0.0323988970588235,0.0331648284313725,0.0344669117647059,0.0389859068627451,0.0425857843137255,0.0433517156862745,0.043734681372549,0.0441942401960784,0.0458026960784314,0.046109068627451,0.046109068627451,0.051547181372549,0.0517003676470588,0.0533854166666667,0.0545343137254902,0.0586703431372549,0.0586703431372549,0.0606617647058824,0.0611979166666667,0.0613511029411765,0.0624234068627451,0.0634957107843137,0.0683210784313725,0.0683210784313725,0.0693933823529412,0.0701593137254902,0.0703125,0.0750612745098039,0.0750612745098039,0.0752144607843137,0.0752910539215686,0.0770526960784314,0.0798866421568627,0.08203125,0.0823376225490196,0.0838694852941176,0.0844822303921569,0.0871629901960784,0.0873927696078431,0.0880821078431373,0.0897671568627451,0.0902267156862745,0.0955116421568627,0.0962775735294118,0.0979626225490196,0.100260416666667,0.100490196078431,0.101485906862745,0.102022058823529,0.102558210784314,0.104932598039216,0.107996323529412,0.108762254901961,0.114353553921569,0.116421568627451,0.116957720588235,0.11749387254902,0.120557598039216,0.121859681372549,0.126225490196078,0.126991421568627,0.127604166666667,0.133731617647059,0.135952818627451,0.137561274509804,0.138020833333333,0.14483762254902,0.146446078431373,0.146752450980392,0.146752450980392,0.147365196078431,0.147977941176471,0.148514093137255]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Gene<\\/th>\\n      <th>rankscore<\\/th>\\n      <th>FDR<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 5, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Enrichment of Td- vs. Td+ at Day14, with MC computed FDR\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrraS87[!is.na(rankscore) & FDR < .15] %>% DT::datatable() %>% DT::formatRound(\"FDR\", digits = 5)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-e92d12dc60802a062a29\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e92d12dc60802a062a29\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\"],[\"ZNF441\",\"ZNF440\",\"CRY1\",\"E2F1\",\"CDX4\",\"BHLHA15\",\"ZNF311\",\"EGR3\",\"ZIC1\",\"NR1I2\",\"ZNF250\",\"ZNF639\",\"PRDM6\",\"DLX5\",\"TOX4\",\"THRA\",\"BRWD1\",\"CHD5\",\"CBX4\",\"VAX2\",\"ZBTB18\",\"RAI14\",\"RBPJ\",\"TSHZ3\",\"NKX3-2\",\"TAF1L\",\"APBB2\",\"SCRT2\",\"HSFY1\",\"ZNF136\",\"EMX1\",\"UBE2K\",\"CTDP1\",\"JUNB\",\"MECP2\",\"POLR2B\",\"ZZZ3\",\"NonTargeting_Human_22\",\"ZNF554\",\"KLF10\",\"INSM1\",\"MEOX2\",\"ZNF671\",\"NonTargeting_Human_90\",\"SMAD3\",\"EBF1\",\"ZNF563\",\"PAX7\",\"ZNF141\",\"ZFPM1\",\"HIST1H2BC\",\"JUND\",\"HTATIP2\",\"PRDM5\",\"GATA1\",\"TFEB\",\"CREBZF\",\"VGLL2\",\"SKI\",\"ZFY\",\"HIF3A\",\"NonTargeting_Human_13\",\"ELK3\",\"NonTargeting_Human_31\",\"NonTargeting_Human_57\",\"ZIM3\",\"ARID1B\",\"AHR\",\"NonTargeting_Human_88\",\"NFAT5\",\"NEUROG3\",\"TSC22D3\",\"LHX4\",\"NonTargeting_Human_69\",\"ZNF239\",\"NonTargeting_Human_39\",\"SIX5\",\"ZNF510\",\"PAX2\",\"ZNF92\",\"CTNNB1\",\"TAF5\",\"NFKBIB\",\"NonTargeting_Human_99\",\"ZKSCAN3\",\"AFF4\",\"ATF6B\",\"ARNTL\",\"TCEA2\",\"PHF12\",\"MPHOSPH8\",\"ZNF34\",\"RORB\",\"HOXB3\"],[10.75,53.25,54.25,77.75,81.25,84.5,95.5,105.5,107.75,112.75,133.25,133.25,135,136.75,139.75,140,143.5,145,162.5,162.5,164.75,165,166.25,171,173.75,176.75,178.5,180,183.25,190,197.75,197.75,204.25,206.25,209.25,210,210,212.5,214,220.5,229.5,232,232,236.5,239,240,250.25,252,253,258.75,264,267.75,268.75,280.25,295,296.5,297.5,297.75,298,298,301.75,306,318,319,319.25,320.25,323.5,324.75,325.25,328.5,333.25,335.5,341,341.75,343.25,346.75,347.25,355.25,357,362.5,363.75,365.25,368,369.75,380,380.75,381,381.25,382.25,384.5,385.25,390.75,397.25,399.25],[0.000165549209502525,0.00339375879480175,0.00339375879480175,0.00678751758960351,0.00720139061335982,0.00753248903236487,0.00993295257015148,0.0118367684794305,0.0126645145269431,0.0133267113649532,0.0173826669977651,0.0173826669977651,0.0176309908120189,0.0181276384405264,0.0191209336975416,0.0191209336975416,0.0202797781640593,0.0203625527688105,0.0261567751013989,0.0261567751013989,0.026818971939409,0.0269017465441603,0.027150070358414,0.0291366608724443,0.0297160831057032,0.0309577021769721,0.032199321248241,0.0331098419005049,0.0341859117622713,0.0365036006953067,0.0394834864663521,0.0394834864663521,0.042297823027895,0.0432911182849102,0.0446982865656817,0.0451949341941892,0.0451949341941892,0.0456915818226968,0.0463537786607069,0.0480920453604834,0.0521480009932953,0.0535551692740667,0.0535551692740667,0.0558728582071021,0.0568661534641172,0.0571972518831223,0.0610048837016803,0.0619154043539442,0.062494826587203,0.065309163148746,0.06754407747703,0.0696962172005629,0.0700273156195679,0.0754904395331512,0.0821951825180035,0.082691830146511,0.0836023507987749,0.0836023507987749,0.0837679000082775,0.0837679000082775,0.085837265127059,0.0881549540600944,0.0939491763926827,0.0946941478354441,0.0950252462544491,0.095604668487708,0.0974257097922357,0.0979223574207433,0.0981706812349971,0.100819468587037,0.103385481334327,0.104875424219849,0.108103633805149,0.108351957619402,0.109345252876418,0.111000744971443,0.111414617995199,0.116381094280275,0.117539938746792,0.121182021355848,0.121513119774853,0.122589189636619,0.124493005545899,0.125817399221919,0.132356592997268,0.132770466021025,0.132853240625776,0.133018789835279,0.133515437463786,0.135833126396821,0.136081450211075,0.139557983610628,0.14361393924344,0.144772783709958]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Gene<\\/th>\\n      <th>rankscore<\\/th>\\n      <th>FDR<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 5, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Depletion of Td+ vs. iN at Day14, with MC computed FDR\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrraS76[FDR < .15] %>% DT::datatable() %>% DT::formatRound(\"FDR\", digits = 5)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-f4bad5d0e350d65bd96b\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f4bad5d0e350d65bd96b\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\",\"281\",\"282\",\"283\",\"284\",\"285\",\"286\",\"287\",\"288\",\"289\",\"290\",\"291\",\"292\",\"293\",\"294\",\"295\",\"296\",\"297\",\"298\",\"299\",\"300\",\"301\",\"302\",\"303\",\"304\",\"305\",\"306\",\"307\",\"308\",\"309\"],[\"MXI1\",\"NCOA3\",\"NR5A2\",\"TFEC\",\"HIF1AN\",\"ZNF85\",\"MCM7\",\"PRDM5\",\"SMARCA5\",\"ZFPL1\",\"ZNF582\",\"ZNF337\",\"HDAC9\",\"ANKZF1\",\"MAML3\",\"RBBP7\",\"NKX2-1\",\"EIF2AK2\",\"MYBBP1A\",\"EWSR1\",\"MCM3\",\"NOTCH3\",\"NUPR1\",\"ZNF107\",\"SRF\",\"GFI1\",\"ARID1B\",\"STAT4\",\"YEATS2\",\"ZNF207\",\"GRHL1\",\"EGR1\",\"HNRNPUL1\",\"MNX1\",\"TBX6\",\"PHF6\",\"PHF7\",\"LZTR1\",\"TAF6\",\"SMARCB1\",\"GTF2B\",\"ZNF462\",\"BCL3\",\"JMJD1C\",\"MED21\",\"KMT2D\",\"ZNF256\",\"ZNF469\",\"NCOA1\",\"BCL11A\",\"PIR\",\"ATF6B\",\"ZNF100\",\"IRX4\",\"FOXD3\",\"PAX8\",\"ID3\",\"PRDM9\",\"ZNF235\",\"ZNF383\",\"ANKRD42\",\"PRDM13\",\"ZNF292\",\"NCOA2\",\"ZSCAN18\",\"TRIP11\",\"TIAL1\",\"MZF1\",\"ZNF580\",\"HNRNPD\",\"NPAS3\",\"NDNL2\",\"IKBKG\",\"RBL1\",\"BARX1\",\"KDM2A\",\"TOX2\",\"GMEB2\",\"SNRPB\",\"RERE\",\"TCF21\",\"CERS2\",\"ZBTB10\",\"ZNF80\",\"BAZ1B\",\"MED1\",\"HIC2\",\"NFIB\",\"ZNF573\",\"PRDM14\",\"HES6\",\"LDB1\",\"TBX18\",\"HMGB3\",\"UBP1\",\"BARX2\",\"ISL2\",\"ZRANB2\",\"KDM4A\",\"POLR3E\",\"CUX1\",\"NR4A2\",\"HCLS1\",\"BCOR\",\"ZDHHC16\",\"ZSWIM4\",\"DAXX\",\"ARNT\",\"SNAPC3\",\"ZDHHC9\",\"ZNF653\",\"NFXL1\",\"ATF1\",\"CXXC1\",\"TP53BP1\",\"NELFE\",\"YEATS4\",\"INSM1\",\"ZMYND11\",\"MYCL\",\"ZNF451\",\"ZFP37\",\"ZBTB14\",\"SOX6\",\"SOX2\",\"SREBF2\",\"MTA2\",\"MTF2\",\"ZZZ3\",\"TMF1\",\"COPS5\",\"PHTF1\",\"TBX22\",\"TCEA2\",\"NFKBIZ\",\"NKD2\",\"MAFF\",\"MXD1\",\"DAZAP2\",\"ARNTL2\",\"NELFB\",\"URI1\",\"FOXN2\",\"SFSWAP\",\"MED8\",\"SUGP1\",\"SCRT2\",\"BARHL2\",\"CREBZF\",\"TFDP2\",\"NKRF\",\"EBF3\",\"PHF21A\",\"TLE6\",\"RAX2\",\"BNC1\",\"CDX2\",\"GTF2E1\",\"SCML2\",\"CSRP3\",\"CDX1\",\"RBBP4\",\"GATAD2B\",\"ZNF500\",\"PTMA\",\"ARID3B\",\"SP100\",\"MSX2\",\"ZNF324\",\"HIST1H1T\",\"TONSL\",\"ASCC1\",\"TAL2\",\"FOXP3\",\"ZNF592\",\"PDLIM4\",\"TBX15\",\"HINFP\",\"TLX1\",\"SMARCC1\",\"ZNF221\",\"SPI1\",\"SIX5\",\"GATAD1\",\"EGR2\",\"FIGLA\",\"CEBPE\",\"ZNF638\",\"MPLKIP\",\"SOWAHC\",\"TRIM5\",\"ATF7IP\",\"CTNNBL1\",\"ASCL3\",\"MCM5\",\"MED15\",\"POLR3F\",\"EAF1\",\"ARNT2\",\"HOXB5\",\"ZNF593\",\"PHF23\",\"MYEF2\",\"SRSF5\",\"ZNF641\",\"MCM8\",\"NFATC2\",\"NR0B1\",\"ADNP2\",\"YAF2\",\"TCEB3C\",\"ZKSCAN7\",\"HOXC5\",\"ZNF446\",\"TOP2B\",\"TP63\",\"UBTF\",\"SIRT4\",\"HMGN4\",\"POU3F2\",\"MYT1L\",\"POLR1C\",\"POU4F1\",\"IRF5\",\"ZNF32\",\"MCM4\",\"CEBPD\",\"HSBP1\",\"RFC1\",\"MED23\",\"MED27\",\"ZNF490\",\"ZSCAN23\",\"ZBTB20\",\"SNAI1\",\"NR1H3\",\"HAND1\",\"EHMT1\",\"TRIM31\",\"MYB\",\"FOXK2\",\"POU6F1\",\"FOXN4\",\"SMAD6\",\"WT1\",\"CTCF\",\"IRF3\",\"MITF\",\"ANKRA2\",\"TFAP4\",\"PAX4\",\"ZSCAN10\",\"TSHZ2\",\"SUPT5H\",\"ENO1\",\"VSX1\",\"ZNF343\",\"PMS1\",\"ABT1\",\"ZNF34\",\"RARB\",\"CALCOCO1\",\"SAP30BP\",\"ZNF700\",\"ZNF480\",\"ZBTB3\",\"LEF1\",\"DEK\",\"NonTargeting_Human_57\",\"ZNF566\",\"GATA3\",\"TAF4\",\"RFX3\",\"KMT2A\",\"FOSL2\",\"ASB8\",\"GLIS1\",\"TRIM25\",\"HIRA\",\"HEYL\",\"VAX1\",\"TAF9B\",\"CNBP\",\"BLZF1\",\"IRF7\",\"ZNF143\",\"CASZ1\",\"GTF3C3\",\"TBX1\",\"IRX2\",\"BRCA1\",\"HIST1H2BJ\",\"NR1D2\",\"ZFPM1\",\"NR1D1\",\"EPC1\",\"NonTargeting_Human_12\",\"ZNF584\",\"BAZ1A\",\"NEUROG1\",\"ZFP57\",\"ZNF7\",\"HMG20A\",\"HOXB8\",\"EZH2\",\"NFKB1\",\"TBX5\",\"ANKRD1\",\"ZNF229\"],[62.5,65,70.25,84,87.5,88.5,91,122,142.5,145.5,147.5,164.75,174.75,186.25,186.25,207.75,209.75,214.25,215.75,219.25,220.75,230.75,233,241.75,243.5,253.25,255.75,256.25,257,260,261,273.75,278.5,301.75,305.75,306.75,309.5,312,313.5,324.25,332.75,338.5,341,344.75,352,362.75,364.75,366.5,367.25,370.75,371.75,375,378,382,394.25,396,407,407.75,409.75,412,419.5,419.75,426.25,432,434.25,434.75,436,439.5,439.5,440.25,440.25,441.25,441.5,443,446.75,450,455.75,456.5,456.75,457,457.5,458.75,460.25,468.25,474.25,475,477,483.75,487.5,488.5,490.5,501.75,504.75,510.25,515.25,529,529,535.75,554,558.5,560.75,561.75,567.75,571.5,572.25,578,587.5,591.5,600.75,601.75,602.25,603.5,607.25,609.75,619.75,620.5,620.75,623.75,625.25,632,632.25,639.5,640.75,641.75,642,642.75,645.25,652,654.5,658.75,660,660.75,663.75,674,681,681.25,693.25,694.75,695.25,701,703.75,707.75,718.25,718.25,724.75,725.75,728.75,729.75,735,737,739.75,741,743,746.25,746.75,747.25,754.75,756.75,770.75,780,786.5,799.75,806,812.25,822.5,825.5,829.25,834,835.75,838.25,843.25,843.5,845.75,850,854.75,855.75,861,867.5,868.75,869,873.75,877.75,885.75,886,887.5,892.75,895.25,896,901.75,903,907.75,909,909.75,920,920.5,921.75,923,928,930.75,931,937,943,952.75,954,958,959.5,961.25,966.75,972.75,972.75,974.5,978.25,979.75,980.25,981,990.25,990.75,999,1010,1010.5,1016.5,1021.25,1024.5,1024.75,1028.25,1028.75,1029,1031.25,1033,1041,1043.75,1044.75,1047.75,1053,1054.75,1055.5,1056,1056.75,1056.75,1057.5,1057.75,1058.75,1059.5,1062,1064.5,1068.5,1068.75,1069,1070.25,1077,1077.25,1077.5,1078.25,1085.25,1091.75,1093.25,1093.5,1094,1096.5,1097.75,1098.25,1100,1101.5,1102.25,1103.25,1105,1105.75,1107,1112.75,1114.5,1115.75,1116.25,1116.75,1119.75,1121.25,1123.75,1124.75,1125,1125.5,1129.25,1131.25,1132.75,1133.5,1136.5,1138.25,1139.25,1144.25,1145.75,1147.25,1147.5,1150.75,1152.5,1154,1155.75,1157.25,1158,1159.25,1161,1163.75,1165.5,1168.25,1168.25,1175,1175.25,1176.25,1176.5,1176.5,1177.75,1178.25],[0.000607594936708861,0.000632911392405063,0.000683544303797468,0.00113924050632911,0.00129113924050633,0.00131645569620253,0.00139240506329114,0.00253164556962025,0.00329113924050633,0.00336708860759494,0.00341772151898734,0.00417721518987342,0.00463291139240506,0.0050126582278481,0.0050126582278481,0.00610126582278481,0.00627848101265823,0.00648101265822785,0.00653164556962025,0.00678481012658228,0.00688607594936709,0.00736708860759494,0.00756962025316456,0.00807594936708861,0.00812658227848101,0.0090379746835443,0.00924050632911392,0.00929113924050633,0.00939240506329114,0.00972151898734177,0.00979746835443038,0.0107594936708861,0.0109873417721519,0.0128607594936709,0.0131139240506329,0.0131645569620253,0.0133670886075949,0.0135949367088608,0.013746835443038,0.0146075949367089,0.0152658227848101,0.0158227848101266,0.0161012658227848,0.0165316455696203,0.0169873417721519,0.0177215189873418,0.0179493670886076,0.0180253164556962,0.0181518987341772,0.0184303797468354,0.0184810126582278,0.0188860759493671,0.0192911392405063,0.0197974683544304,0.0209113924050633,0.0210379746835443,0.0220506329113924,0.0221518987341772,0.0222784810126582,0.022506329113924,0.0232405063291139,0.0232405063291139,0.0243037974683544,0.0250126582278481,0.0253164556962025,0.0253417721518987,0.0254936708860759,0.0258987341772152,0.0258987341772152,0.0260506329113924,0.0260506329113924,0.0261772151898734,0.0262025316455696,0.026379746835443,0.0269873417721519,0.0274177215189873,0.0280506329113924,0.028126582278481,0.028126582278481,0.0281772151898734,0.0282025316455696,0.028379746835443,0.0285063291139241,0.0295696202531646,0.030126582278481,0.0302278481012658,0.0303291139240506,0.0310126582278481,0.0313924050632911,0.0314177215189873,0.0316455696202532,0.0328354430379747,0.0332151898734177,0.0339746835443038,0.0344303797468354,0.036253164556962,0.036253164556962,0.0369367088607595,0.0391645569620253,0.0397974683544304,0.0400506329113924,0.0402278481012658,0.0410379746835443,0.0417215189873418,0.0418227848101266,0.0426835443037975,0.0439493670886076,0.0444556962025316,0.045620253164557,0.0457215189873418,0.0458227848101266,0.046,0.0464303797468354,0.0465316455696203,0.0479746835443038,0.0481012658227848,0.0481772151898734,0.0486075949367089,0.0487594936708861,0.049620253164557,0.0496455696202532,0.0508101265822785,0.0510126582278481,0.0512151898734177,0.0512658227848101,0.0513670886075949,0.051746835443038,0.0527088607594937,0.0532658227848101,0.0539240506329114,0.0540506329113924,0.0541772151898734,0.0546329113924051,0.0559746835443038,0.0568607594936709,0.0569113924050633,0.0584810126582278,0.0586582278481013,0.0587088607594937,0.0595189873417722,0.0598481012658228,0.0604050632911392,0.0623037974683544,0.0623037974683544,0.0633164556962025,0.063493670886076,0.0641772151898734,0.0644556962025317,0.0652911392405063,0.0654683544303798,0.0657215189873418,0.0658987341772152,0.0663291139240506,0.0667088607594937,0.0667341772151899,0.0668354430379747,0.0679240506329114,0.0681772151898734,0.0705822784810127,0.0720506329113924,0.0732151898734177,0.0754430379746835,0.076506329113924,0.0773924050632911,0.0786075949367089,0.0790126582278481,0.0795443037974684,0.0804303797468354,0.0806582278481013,0.0809873417721519,0.0818481012658228,0.082,0.082379746835443,0.0830632911392405,0.0839493670886076,0.0842025316455696,0.0849873417721519,0.0864050632911392,0.0867848101265823,0.0868101265822785,0.0876708860759494,0.0883037974683544,0.0893924050632911,0.0894683544303797,0.0896708860759494,0.0908101265822785,0.0911898734177215,0.0913417721518987,0.0924050632911392,0.0926075949367089,0.0934936708860759,0.0937721518987342,0.0939240506329114,0.0959746835443038,0.096,0.0963291139240506,0.0965316455696203,0.0971645569620253,0.0977215189873418,0.0977215189873418,0.0993417721518987,0.100405063291139,0.102329113924051,0.102632911392405,0.10346835443038,0.103822784810127,0.104,0.105240506329114,0.106607594936709,0.106607594936709,0.107063291139241,0.107620253164557,0.107822784810127,0.107898734177215,0.108050632911392,0.110025316455696,0.110151898734177,0.111822784810127,0.113898734177215,0.114,0.115164556962025,0.116,0.116632911392405,0.116658227848101,0.117215189873418,0.117367088607595,0.117443037974684,0.118050632911392,0.118455696202532,0.120151898734177,0.120632911392405,0.120784810126582,0.121341772151899,0.122227848101266,0.122556962025316,0.122658227848101,0.122784810126582,0.122860759493671,0.122860759493671,0.122962025316456,0.123012658227848,0.123189873417722,0.123341772151899,0.123974683544304,0.124607594936709,0.125367088607595,0.125367088607595,0.125417721518987,0.125696202531646,0.12693670886076,0.126987341772152,0.127037974683544,0.127088607594937,0.128556962025316,0.129544303797468,0.129822784810127,0.129924050632911,0.130025316455696,0.130784810126582,0.131088607594937,0.131215189873418,0.131544303797468,0.131873417721519,0.131949367088608,0.132126582278481,0.132430379746835,0.132607594936709,0.132911392405063,0.134354430379747,0.13473417721519,0.134911392405063,0.134987341772152,0.135037974683544,0.135417721518987,0.135746835443038,0.136430379746835,0.136632911392405,0.136708860759494,0.136886075949367,0.137569620253165,0.137873417721519,0.138075949367089,0.138379746835443,0.139113924050633,0.139594936708861,0.139696202531646,0.140683544303797,0.140936708860759,0.141164556962025,0.141164556962025,0.141822784810127,0.142126582278481,0.142430379746835,0.142810126582278,0.143063291139241,0.143367088607595,0.143544303797468,0.143949367088608,0.144481012658228,0.144810126582278,0.145291139240506,0.145291139240506,0.146632911392405,0.146683544303797,0.146936708860759,0.147012658227848,0.147012658227848,0.147240506329114,0.147392405063291]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Gene<\\/th>\\n      <th>rankscore<\\/th>\\n      <th>FDR<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 5, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Compare with hits found from existing method, using FDR\\< .15\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhitlist = fread(\"../code/resources/crispr/Hitlist_20191230.csv\")\n```\n:::\n\n\nPrevious method found 122 genes, shown below:\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-6c2825bd19d6c8caa415\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-6c2825bd19d6c8caa415\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\"],[\"ZNF441\",\"ZNF440\",\"CRY1\",\"E2F1\",\"CDX4\",\"BHLHA15\",\"ZNF311\",\"EGR3\",\"ZIC1\",\"NR1I2\",\"ZNF639\",\"ZNF250\",\"PRDM6\",\"DLX5\",\"TOX4\",\"THRA\",\"BRWD1\",\"CHD5\",\"VAX2\",\"CBX4\",\"ZBTB18\",\"RAI14\",\"RBPJ\",\"TSHZ3\",\"NKX3-2\",\"TAF1L\",\"APBB2\",\"SCRT2\",\"HSFY1\",\"ZNF136\",\"EMX1\",\"UBE2K\",\"CTDP1\",\"JUNB\",\"MECP2\",\"POLR2B\",\"ZZZ3\",\"ZNF554\",\"KLF10\",\"INSM1\",\"ZNF671\",\"MEOX2\",\"SMAD3\",\"EBF1\",\"ZNF563\",\"PAX7\",\"ZNF141\",\"ZFPM1\",\"HIST1H2BC\",\"JUND\",\"HTATIP2\",\"PRDM5\",\"GATA1\",\"TFEB\",\"CREBZF\",\"VGLL2\",\"ZFY\",\"SKI\",\"HIF3A\",\"ELK3\",\"ZIM3\",\"ARID1B\",\"AHR\",\"NFAT5\",\"NEUROG3\",\"TSC22D3\",\"LHX4\",\"ZNF239\",\"SIX5\",\"ZNF510\",\"PAX2\",\"ZNF92\",\"CTNNB1\",\"TAF5\",\"NFKBIB\",\"ZKSCAN3\",\"AFF4\",\"ARNTL\",\"TCEA2\",\"PHF12\",\"MPHOSPH8\",\"ZNF34\",\"RORB\",\"HOXB3\",\"FOXQ1\",\"POU2F3\",\"ZNF502\",\"ZNF324\",\"SLA2\",\"TBPL1\",\"KLF14\",\"ZBTB43\",\"HOXC13\",\"AIP\",\"NBPF24\",\"ZNF282\",\"ISL2\",\"CEBPA\",\"PHOX2A\",\"NKRF\",\"SNAI2\",\"FOXN2\",\"MLLT6\",\"RCOR2\",\"NR1D2\",\"ZNF547\",\"POLR2J\",\"SOX15\",\"JADE3\",\"ZFP2\",\"POU3F2\",\"ASB1\",\"ZNF3\",\"HIST1H1E\",\"ZNF573\",\"ZNF200\",\"ZNF107\",\"NEUROG1\",\"CNOT6\",\"GTF2A2\",\"EHF\",\"NEUROG2\"],[10.75,53.25,54.25,77.75,81.25,84.5,95.5,105.5,107.75,112.75,133.25,133.25,135,136.75,139.75,140,143.5,145,162.5,162.5,164.75,165,166.25,171,173.75,176.75,178.5,180,183.25,190,197.75,197.75,204.25,206.25,209.25,210,210,214,220.5,229.5,232,232,239,240,250.25,252,253,258.75,264,267.75,268.75,280.25,295,296.5,297.5,297.75,298,298,301.75,318,320.25,323.5,324.75,328.5,333.25,335.5,341,343.25,347.25,355.25,357,362.5,363.75,365.25,368,380,380.75,381.25,382.25,384.5,385.25,390.75,397.25,399.25,414.25,421.25,426.5,428.25,429.75,432.75,433.25,435,435.25,438,440.5,450.75,451,453,457.75,461.75,469.25,470.5,471,474.25,474.75,479.5,483.75,487,495.25,511.25,526.75,528,529.75,529.75,540,544.25,564.5,802.25,857.75,null,null,null],[0.000165549209502525,0.00339375879480175,0.00339375879480175,0.00678751758960351,0.00720139061335982,0.00753248903236487,0.00993295257015148,0.0118367684794305,0.0126645145269431,0.0133267113649532,0.0173826669977651,0.0173826669977651,0.0176309908120189,0.0181276384405264,0.0191209336975416,0.0191209336975416,0.0202797781640593,0.0203625527688105,0.0261567751013989,0.0261567751013989,0.026818971939409,0.0269017465441603,0.027150070358414,0.0291366608724443,0.0297160831057032,0.0309577021769721,0.032199321248241,0.0331098419005049,0.0341859117622713,0.0365036006953067,0.0394834864663521,0.0394834864663521,0.042297823027895,0.0432911182849102,0.0446982865656817,0.0451949341941892,0.0451949341941892,0.0463537786607069,0.0480920453604834,0.0521480009932953,0.0535551692740667,0.0535551692740667,0.0568661534641172,0.0571972518831223,0.0610048837016803,0.0619154043539442,0.062494826587203,0.065309163148746,0.06754407747703,0.0696962172005629,0.0700273156195679,0.0754904395331512,0.0821951825180035,0.082691830146511,0.0836023507987749,0.0836023507987749,0.0837679000082775,0.0837679000082775,0.085837265127059,0.0939491763926827,0.095604668487708,0.0974257097922357,0.0979223574207433,0.100819468587037,0.103385481334327,0.104875424219849,0.108103633805149,0.109345252876418,0.111414617995199,0.116381094280275,0.117539938746792,0.121182021355848,0.121513119774853,0.122589189636619,0.124493005545899,0.132356592997268,0.132770466021025,0.133018789835279,0.133515437463786,0.135833126396821,0.136081450211075,0.139557983610628,0.14361393924344,0.144772783709958,0.155699031537124,0.160251634798444,0.164804238059763,0.165797533316778,0.16720470159755,0.169605165135336,0.16985348894959,0.171757304858869,0.171922854068372,0.173909444582402,0.175647711282179,0.184752917804817,0.18491846701432,0.186739508318848,0.190712689346908,0.193692575117954,0.198162403774522,0.199072924426786,0.199404022845791,0.202383908616836,0.202797781640593,0.205943216621141,0.210081946858704,0.212068537372734,0.218690505752835,0.230361725022763,0.241122423640427,0.242281268106945,0.243688436387716,0.243688436387716,0.250310404767817,0.255276881052893,0.271666252793643,0.488866815660955,0.544822448472809,null,null,null]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Gene<\\/th>\\n      <th>rankscore<\\/th>\\n      <th>FDR<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 5, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics(\"venn.svg\")\n```\n\n::: {.cell-output-display}\n![](venn.svg)\n:::\n:::\n\n\n\n\n\n\nNotice a large number of overlaps. When we combine hits found from Td- vs. iN and Td- vs. Td+ with FDR \\< 0.15 (which is the same way we selected our 120 hits. There are 23 (NEUROG1 and NEUROG2 are not considered) hits found in existing method, but not found in the RRA method. Nearly all the hits that we initially removed in our existing method, which are labeled as hit with the RRA method are non-targeting controls. This highlights the advantage of our existing manual method of more precise control of false positives and potential false negatives. Of course, the disadvantage is that the existing manual method does not produce a p-value thus is less informative in statistical confidence.\n\nBelow shows hits that are found in both this method and our existing method. Notice many of these TFs are repeatedly identified as differentially expressed as well as later identified as nodes in the putative neuronal development gene regulatory network.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nintersect(union(set87, set86), hitlist$gene_name) %>% length\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 96\n```\n:::\n\n```{.r .cell-code}\nintersect(union(set87, set86), hitlist$gene_name)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"ZNF441\"    \"ZNF440\"    \"CRY1\"      \"E2F1\"      \"CDX4\"      \"BHLHA15\"  \n [7] \"ZNF311\"    \"EGR3\"      \"ZIC1\"      \"NR1I2\"     \"ZNF250\"    \"ZNF639\"   \n[13] \"PRDM6\"     \"DLX5\"      \"TOX4\"      \"THRA\"      \"BRWD1\"     \"CHD5\"     \n[19] \"CBX4\"      \"VAX2\"      \"ZBTB18\"    \"RAI14\"     \"RBPJ\"      \"TSHZ3\"    \n[25] \"NKX3-2\"    \"TAF1L\"     \"APBB2\"     \"SCRT2\"     \"HSFY1\"     \"ZNF136\"   \n[31] \"EMX1\"      \"UBE2K\"     \"CTDP1\"     \"JUNB\"      \"MECP2\"     \"POLR2B\"   \n[37] \"ZZZ3\"      \"ZNF554\"    \"KLF10\"     \"INSM1\"     \"MEOX2\"     \"ZNF671\"   \n[43] \"SMAD3\"     \"EBF1\"      \"ZNF563\"    \"PAX7\"      \"ZNF141\"    \"ZFPM1\"    \n[49] \"HIST1H2BC\" \"JUND\"      \"HTATIP2\"   \"PRDM5\"     \"GATA1\"     \"TFEB\"     \n[55] \"CREBZF\"    \"VGLL2\"     \"SKI\"       \"ZFY\"       \"HIF3A\"     \"ELK3\"     \n[61] \"ZIM3\"      \"ARID1B\"    \"AHR\"       \"NFAT5\"     \"NEUROG3\"   \"TSC22D3\"  \n[67] \"LHX4\"      \"ZNF239\"    \"SIX5\"      \"ZNF510\"    \"PAX2\"      \"ZNF92\"    \n[73] \"CTNNB1\"    \"TAF5\"      \"NFKBIB\"    \"ZKSCAN3\"   \"AFF4\"      \"ARNTL\"    \n[79] \"TCEA2\"     \"PHF12\"     \"MPHOSPH8\"  \"ZNF34\"     \"RORB\"      \"HOXB3\"    \n[85] \"ISL2\"      \"ZNF502\"    \"FOXQ1\"     \"HOXC13\"    \"POU2F3\"    \"POLR2J\"   \n[91] \"TBPL1\"     \"AIP\"       \"ZNF282\"    \"CNOT6\"     \"ZNF547\"    \"RCOR2\"    \n```\n:::\n:::\n\n\nBelow are hits that are found in our existing method but missed in this method.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetdiff(hitlist$gene_name, union(set87, set86))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"PHOX2A\"   \"SNAI2\"    \"ZBTB43\"   \"ZNF200\"   \"MLLT6\"    \"ZNF3\"    \n [7] \"ZNF324\"   \"ASB1\"     \"GTF2A2\"   \"JADE3\"    \"ZNF573\"   \"NBPF24\"  \n[13] \"SOX15\"    \"FOXN2\"    \"CEBPA\"    \"NKRF\"     \"NR1D2\"    \"EHF\"     \n[19] \"POU3F2\"   \"KLF14\"    \"SLA2\"     \"ZFP2\"     \"ZNF107\"   \"NEUROG1\" \n[25] \"NEUROG2\"  \"HIST1H1E\"\n```\n:::\n:::\n\n\nBelow are labeled hits in this method but rejected in our existing method. Notice many are in fact non-targeting controls, suggesting our existing method may be better suited in removing false positives.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetdiff(union(set87, set86), hitlist$gene_name)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"NonTargeting_Human_22\" \"NonTargeting_Human_90\" \"NonTargeting_Human_13\"\n [4] \"NonTargeting_Human_31\" \"NonTargeting_Human_57\" \"NonTargeting_Human_88\"\n [7] \"NonTargeting_Human_69\" \"NonTargeting_Human_39\" \"NonTargeting_Human_99\"\n[10] \"ATF6B\"                 \"NonTargeting_Human_67\" \"ZNF766\"               \n[13] \"NonTargeting_Human_64\"\n```\n:::\n:::\n\n\n\n## Compare with other papers\n\n\n### Take Tian et. al Neuron 2019 screen data\n\nHits are selected from their day 14 Neuron hits with pvalue < 0.01. Since most genes dropped out, only found 3 overlapping genes, of which `CTDP1` pass 15% FDR. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntian_day14 = readxl::read_excel(\"../data/tian_neuron2019/mmc2.xlsx\", sheet = \"Day 14 neuron\")\ntian_day14_hits = filter(tian_day14, Pvalue < 0.01) %>% pull(`Gene symbol`)\nrraS86[Gene %in% tian_day14_hits]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Gene rankscore        FDR\n1:  CTDP1     237.0 0.05338542\n2:   RXRB     602.0 0.28071385\n3: TRIM33    1156.5 0.79266238\n```\n:::\n:::\n\n\nAre our hits in their data?\n\nOnly 5 of our hits were in their data, of which, 1 significant with 0.001 as cutoff. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntian_day14 %>% filter(`Gene symbol` %in% hitlist$gene_name) %>% \n  arrange(Pvalue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 5\n  Target `Gene symbol` `Knockdown phenotype`  Pvalue Product\n  <chr>  <chr>                         <dbl>   <dbl>   <dbl>\n1 CTDP1  CTDP1                       -0.497  0.00308 -1.25  \n2 ZFY    ZFY                          0.0968 0.119    0.0894\n3 NR1I2  NR1I2                        0.346  0.125    0.313 \n4 THRA   THRA                        -0.182  0.265   -0.105 \n5 TAF1L  TAF1L                        0.0678 0.406    0.0265\n```\n:::\n:::\n\n\n\n## Liu et al., Cell Stem Cell 2018 screen data\n\nOnly raw data available, analysis TBD.\n\n\n## Black et al. Cell Reports 2020 screend ata\n\nCounts data and screen results with p-value availabl, analyses TBD. \n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.24/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
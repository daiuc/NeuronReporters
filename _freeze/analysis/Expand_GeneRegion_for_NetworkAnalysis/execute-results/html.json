{
  "hash": "1444e978f4b4ab4d43a5529552ec5184",
  "result": {
    "markdown": "---\ntitle: Extended network analysis to include intergenic region\nsubtitle: \"How does the network change if we include intergenic region (100kb upstream of TSS) as opposed to gene body in previous analysis?\"\nauthor: Chao\ndate: 2023-01-11\ncode-fold: true\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nold = \"../code/resources/TFscreen/Interaction_matrix_nofilter_AllTF_20200107.csv\"\nnew = \"../code/results/reviews/interactions/Interaction_matrix_nofilter_AllTF_intergenic_20230111.csv\"\n\ninter = list(genebody = fread(old), intergen = fread(new))\n\nwalk(inter, ~.x[, interaction := paste(regulator_gene, target_gene, sep=\"_\")])\n```\n:::\n\n\n## What's not captured in intergenic vs. genebody?\n\nSome interactions are not captured in the new method, mostly due to the 25 targets being removed. Otherwise, all the interactions are captualized in the expanded method.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nremoved_interactions = setdiff(inter$genebody$interaction,inter$intergen$interaction)\ninter$genebody[interaction %in% removed_interactions, .(regulator_gene, target_gene)][,target_gene] %>% unique\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"CAVIN1\" \"ELOA\"   \"FCMR\"   \"H1-3\"   \"H2BC15\" \"H2BC9\"  \"MRTFB\"  \"NOCT\"  \n [9] \"SLF1\"   \"NSD3\"   \"MRTFA\"  \"NSD2\"   \"CRAMP1\" \"H1-5\"   \"H2BC21\" \"H1-4\"  \n[17] \"H2BC5\"  \"ELOC\"   \"H2BC4\"  \"TLE5\"   \"NSMCE3\" \"ZNF875\" \"H1-2\"   \"H2BC11\"\n[25] \"ELOB\"   \"H1-10\"  \"H1-0\"  \n```\n:::\n:::\n\n\n## How many interactions gained by expanding to intergenic\n\nWe are gaining 178135 interactions. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ngained_interactions = setdiff(inter$intergene$interaction, inter$genebody$interaction) %>%\n  setdiff(., removed_interactions)\n```\n:::\n\n\n## Zoom in on NEUROG2, ZBTB18 as regulators\n\nWe can clearly see by including 100kb of intergenic regions upstream of TSS, the network grew larger. Similar trend can be seen with elevated ATAC-seq reads.\n\n:::{.tabset}\n\n### Network grew!\n\n::: {.cell}\n\n```{.r .cell-code}\nimap(inter, ~.x[regulator_gene %in% c(\"NEUROG2\", \"ZBTB18\", \"EBF1\", \"POU3F2\", \"SNAI2\"), \n    .(N.target = length(unique(target_gene)), lab = .y),\n    by = .(regulator_gene)]) %>% \n  rbindlist %>% \n  ggplot() + geom_col(aes(lab, N.target, fill = regulator_gene), position = \"dodge\") +\n    labs(x = NULL, y = \"Number of interaction targets\\n(before applying fiters)\")\n```\n\n::: {.cell-output-display}\n![](Expand_GeneRegion_for_NetworkAnalysis_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### NEUROG2\n\n::: {.cell}\n\n```{.r .cell-code}\nimap(inter, ~.x[regulator_gene == \"NEUROG2\", \n    .(atac.ES, atac.H16, atac.D1, atac.D4, lab = .y),\n    by = .(regulator_gene, target_gene)]) %>% \n  rbindlist %>% \n  melt(id.var = c(\"regulator_gene\", \"target_gene\", \"lab\"),\n       variable.name = \"type\") %>% \n  ggplot() + geom_boxplot(aes(type, value, color = lab)) +\n    labs(x = NULL, y = NULL, title = \"NEUROG2's normalized ATAC footprints on its targets\")\n```\n\n::: {.cell-output-display}\n![](Expand_GeneRegion_for_NetworkAnalysis_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n### ZBTB18\n\n::: {.cell}\n\n```{.r .cell-code}\nimap(inter, ~.x[regulator_gene == \"ZBTB18\", \n    .(atac.ES, atac.H16, atac.D1, atac.D4, lab = .y),\n    by = .(regulator_gene, target_gene)]) %>% \n  rbindlist %>% \n  melt(id.var = c(\"regulator_gene\", \"target_gene\", \"lab\"),\n       variable.name = \"type\") %>% \n  ggplot() + geom_boxplot(aes(type, value, color = lab)) +\n    scale_y_log10() +\n    labs(x = NULL, y = NULL, title = \"ZBTB18's normalized ATAC footprints on its targets\")\n```\n\n::: {.cell-output-display}\n![](Expand_GeneRegion_for_NetworkAnalysis_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n:::\n\n\n\n\n",
    "supporting": [
      "Expand_GeneRegion_for_NetworkAnalysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}